{
  "resourceType": "Library",
  "id": "qt-prolongation-lens",
  "meta": {
    "profile": [
      "http://hl7.eu/fhir/ig/gravitate-health/StructureDefinition/lens"
    ]
  },
  "type": {
    "coding": [
      {
        "code": "logical-library"
      }
    ]
  },
  "extension": [
    {
      "url": "http://hl7.eu/fhir/ig/gravitate-health/StructureDefinition/lee-version",
      "valueString": "dev"
    }
  ],
  "url": "http://hl7.eu/fhir/ig/gravitate-health/Library/588",
  "identifier": [
    {
      "system": "http://gravitate-health.lst.tfo.upm.es",
      "value": "qt-prolongation-lens"
    }
  ],
  "version": "0.0.1",
  "name": "QT prolongation lens",
  "_name": {
    "extension": [
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "es"
          },
          {
            "url": "content",
            "valueString": "Lente para la prolongación del QT"
          }
        ]
      },
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "pt"
          },
          {
            "url": "content",
            "valueString": "Lente para o prolongamento do QT"
          }
        ]
      },
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "da"
          },
          {
            "url": "content",
            "valueString": "Linse til QT-forlængelse"
          }
        ]
      }
    ]
  },
  "title": "qt-prolongation-lens",
  "_title": {
    "extension": [
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "es"
          },
          {
            "url": "content",
            "valueString": "Lente para la prolongación del QT"
          }
        ]
      },
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "pt"
          },
          {
            "url": "content",
            "valueString": "Lente para o prolongamento do QT"
          }
        ]
      },
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "da"
          },
          {
            "url": "content",
            "valueString": "Linse til QT-forlængelse"
          }
        ]
      }
    ]
  },
  "status": "draft",
  "experimental": true,
  "date": "2026-02-03T15:41:06.677Z",
  "publisher": "Gravitate Health Project - UPM Team",
  "contact": [
    {
      "name": "Gravitate Health",
      "telecom": [
        {
          "system": "url",
          "value": "https://www.gravitatehealth.eu/"
        }
      ]
    }
  ],
  "description": "Lens that highlights QT prolongation risk information when patient is taking Citalopram and has low potassium levels",
  "_description": {
    "extension": [
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "es"
          },
          {
            "url": "content",
            "valueString": "Lente que resalta información sobre el riesgo de prolongación del QT cuando el paciente toma Citalopram y tiene niveles bajos de potasio"
          }
        ]
      },
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "pt"
          },
          {
            "url": "content",
            "valueString": "Lente que destaca informações sobre o risco de prolongamento do QT quando o paciente toma Citalopram e tem níveis baixos de potássio"
          }
        ]
      },
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "da"
          },
          {
            "url": "content",
            "valueString": "Linse der fremhæver information om QT-forlængelsesrisiko når patienten tager Citalopram og har lavt kaliumniveau"
          }
        ]
      }
    ]
  },
  "jurisdiction": [
    {
      "coding": [
        {
          "code": "EU",
          "system": "urn:iso:std:iso:3166"
        }
      ]
    }
  ],
  "purpose": "Highlight QT prolongation risk information in a preprocessed ePI when patient takes Citalopram and has low potassium (K+ < 3.5 mmol/L).",
  "_purpose": {
    "extension": [
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "es"
          },
          {
            "url": "content",
            "valueString": "Resaltar información sobre el riesgo de prolongación del QT en una ePI preprocesada cuando el paciente toma Citalopram y tiene potasio bajo (K+ < 3.5 mmol/L)."
          }
        ]
      },
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "pt"
          },
          {
            "url": "content",
            "valueString": "Destacar informações sobre o risco de prolongamento do QT em uma ePI pré-processada quando o paciente toma Citalopram e tem potássio baixo (K+ < 3.5 mmol/L)."
          }
        ]
      },
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "da"
          },
          {
            "url": "content",
            "valueString": "Fremhæv information om QT-forlængelsesrisiko i en forbehandlet ePI når patienten tager Citalopram og har lavt kalium (K+ < 3.5 mmol/L)."
          }
        ]
      }
    ]
  },
  "usage": "You can import this lens directly to your FHIR Server which suports Library Resource type.",
  "_usage": {
    "extension": [
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "es"
          },
          {
            "url": "content",
            "valueString": "Puedes importar esta lente directamente a tu servidor FHIR que soporte el tipo de recurso Library."
          }
        ]
      },
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "pt"
          },
          {
            "url": "content",
            "valueString": "Podes importar esta lente diretamente para o teu servidor FHIR que suporte o tipo de recurso Library."
          }
        ]
      },
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "da"
          },
          {
            "url": "content",
            "valueString": "Du kan importere denne linse direkte til din FHIR-server, som understøtter ressource-typen Library."
          }
        ]
      }
    ]
  },
  "copyright": "© 2024 Gravitate Health",
  "parameter": [
    {
      "use": "in",
      "documentation": "parameter if it exists",
      "type": "CodeableConcept"
    }
  ],
  "content": [
    {
      "contentType": "application/javascript",
      "title": "Lens for QT prolongation risk",
      "data": "bGV0IGh0bWxEYXRhID0gaHRtbDsNCmxldCBpcHNEYXRhID0gaXBzOw0KbGV0IGxhbmcgPSAiIjsgIC8vIERlZmF1bHQgbGFuZ3VhZ2UsIHdpbGwgYmUgc2V0IGJ5IGVQSQ0KDQpsZXQgZ2V0U3BlY2lmaWNhdGlvbiA9ICgpID0+IHsNCiAgICByZXR1cm4gIjEuMC4wIjsNCn07DQoNCmxldCBhbm5vdGF0aW9uUHJvY2VzcyA9IChsaXN0T2ZDYXRlZ29yaWVzLCBlbmhhbmNlVGFnLCBkb2N1bWVudCwgcmVzcG9uc2UpID0+IHsNCiAgICBsaXN0T2ZDYXRlZ29yaWVzLmZvckVhY2goKGNoZWNrKSA9PiB7DQogICAgICAgIGlmIChyZXNwb25zZS5pbmNsdWRlcyhjaGVjaykpIHsNCiAgICAgICAgICAgIGxldCBlbGVtZW50cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoY2hlY2spOw0KICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgIGVsZW1lbnRzW2ldLmNsYXNzTGlzdC5hZGQoZW5oYW5jZVRhZyk7DQogICAgICAgICAgICAgICAgZWxlbWVudHNbaV0uY2xhc3NMaXN0LmFkZCgicXQtcHJvbG9uZ2F0aW9uLWxlbnMiKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaGVhZCIpLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaGVhZCIpWzBdLnJlbW92ZSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJib2R5IikubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImJvZHkiKVswXS5pbm5lckhUTUw7DQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coIlJlc3BvbnNlOiAiICsgcmVzcG9uc2UpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiUmVzcG9uc2U6ICIgKyBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuaW5uZXJIVE1MKTsNCiAgICAgICAgICAgICAgICByZXNwb25zZSA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5pbm5lckhUTUw7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9KTsNCg0KICAgIGlmIChyZXNwb25zZSA9PSBudWxsIHx8IHJlc3BvbnNlID09ICIiKSB7DQogICAgICAgIHRocm93IG5ldyBFcnJvcigNCiAgICAgICAgICAgICJBbm5vdGF0aW9uIHByb2NjZXNzIGZhaWxlZDogUmV0dXJuZWQgZW1wdHkgb3IgbnVsbCByZXNwb25zZSINCiAgICAgICAgKTsNCiAgICAgICAgLy9yZXR1cm4gaHRtbERhdGENCiAgICB9IGVsc2Ugew0KICAgICAgICBjb25zb2xlLmxvZygiUmVzcG9uc2U6ICIgKyByZXNwb25zZSk7DQogICAgICAgIHJldHVybiByZXNwb25zZTsNCiAgICB9DQp9DQoNCg0KbGV0IGFubm90YXRlSFRNTHNlY3Rpb24gPSBhc3luYyAobGlzdE9mQ2F0ZWdvcmllcywgZW5oYW5jZVRhZykgPT4gew0KICAgIGxldCByZXNwb25zZSA9IGh0bWxEYXRhOw0KICAgIGxldCBkb2N1bWVudDsNCg0KICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAidW5kZWZpbmVkIikgew0KICAgICAgICBsZXQganNkb20gPSBhd2FpdCBpbXBvcnQoImpzZG9tIik7DQogICAgICAgIGxldCB7IEpTRE9NIH0gPSBqc2RvbTsNCiAgICAgICAgbGV0IGRvbSA9IG5ldyBKU0RPTShodG1sRGF0YSk7DQogICAgICAgIGRvY3VtZW50ID0gZG9tLndpbmRvdy5kb2N1bWVudDsNCiAgICAgICAgcmV0dXJuIGFubm90YXRpb25Qcm9jZXNzKGxpc3RPZkNhdGVnb3JpZXMsIGVuaGFuY2VUYWcsIGRvY3VtZW50LCByZXNwb25zZSk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgZG9jdW1lbnQgPSB3aW5kb3cuZG9jdW1lbnQ7DQogICAgICAgIHJldHVybiBhbm5vdGF0aW9uUHJvY2VzcyhsaXN0T2ZDYXRlZ29yaWVzLCBlbmhhbmNlVGFnLCBkb2N1bWVudCwgcmVzcG9uc2UpOw0KICAgIH0NCn07DQoNCg0KDQpsZXQgZW5oYW5jZSA9IGFzeW5jICgpID0+IHsNCiAgICBpZiAoIWlwc0RhdGEgfHwgIWlwc0RhdGEuZW50cnkgfHwgaXBzRGF0YS5lbnRyeS5sZW5ndGggPT09IDApIHsNCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJJUFMgaXMgZW1wdHkgb3IgaW52YWxpZC4iKTsNCiAgICB9DQoNCiAgICAvLyAxLiBDaGVjayBDb21wb3NpdGlvbi5sYW5ndWFnZQ0KICAgIGVwaT8uZW50cnk/LmZvckVhY2goKGVudHJ5KSA9PiB7DQogICAgICAgIGNvbnN0IHJlcyA9IGVudHJ5LnJlc291cmNlOw0KICAgICAgICBpZiAocmVzPy5yZXNvdXJjZVR5cGUgPT09ICJDb21wb3NpdGlvbiIgJiYgcmVzLmxhbmd1YWdlKSB7DQogICAgICAgICAgICBsYW5nID0gcmVzLmxhbmd1YWdlOw0KICAgICAgICAgICAgY29uc29sZS5sb2coIvCfjI0gRGV0ZWN0ZWQgZnJvbSBDb21wb3NpdGlvbi5sYW5ndWFnZToiLCBsYW5nKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KDQogICAgLy8gMi4gSWYgbm90IGZvdW5kLCBjaGVjayBCdW5kbGUubGFuZ3VhZ2UNCiAgICBpZiAoIWxhbmcgJiYgZXBpPy5sYW5ndWFnZSkgew0KICAgICAgICBsYW5nID0gZXBpLmxhbmd1YWdlOw0KICAgICAgICBjb25zb2xlLmxvZygi8J+MjSBEZXRlY3RlZCBmcm9tIEJ1bmRsZS5sYW5ndWFnZToiLCBsYW5nKTsNCiAgICB9DQoNCiAgICAvLyAzLiBGYWxsYmFjaw0KICAgIGlmICghbGFuZykgew0KICAgICAgICBjb25zb2xlLndhcm4oIuKaoO+4jyBObyBsYW5ndWFnZSBkZXRlY3RlZCBpbiBDb21wb3NpdGlvbiBvciBCdW5kbGUuIik7DQogICAgICAgIGxhbmcgPSAiZW4iOw0KICAgIH0NCg0KICAgIGxldCBlbmhhbmNlVGFnID0gImhpZ2hsaWdodCI7DQogICAgbGV0IGxpc3RPZkNhdGVnb3JpZXNUb1NlYXJjaCA9IFt7ICJjb2RlIjogImdyYXYtMSIsICJzeXN0ZW0iOiAiaHR0cDovL2dyYXZpdGF0ZS1oZWFsdGguZXUvY29kZXMiIH1dOyAvL3doYXQgdG8gbG9vayBpbiBleHRlbnNpb25zIC1tYWRlIHVwIGNvZGUgYmVjYXVzZSB0aGVyZSBpcyBub25lDQoNCiAgICAvLyBIaWdobGlnaHQgPFFUIHByb2xvbmdhdGlvbiByaXNrPiBJRiBNZWRpY2F0aW9uUmVxdWVzdC5tZWRpY2F0aW9uID09IFtDaXRhbG9wcmFtXSANCiAgICAvLyBBTkQgT2JzZXJ2YXRpb24uY29kZSA9PSAiSysiIChsb2luYyAyODIzLTMpIEFORCBPYnNlcnZhdGlvbi52YWx1ZSA8IDMuNSBtbW9sL0wNCg0KICAgIGNvbnN0IHBvdGFzc2l1bUNvZGVzID0gWyIyODIzLTMiLCAiNjI5OC00Il07IC8vIHdoYXQgdG8gbG9vayBpbiBJUFMgTGFiDQogICAgY29uc3QgY2l0YWxvcHJhbUtleXdvcmRzID0gWyJjaXRhbG9wcmFtIiwgIkNpdGFsb3ByYW0iXTsgLy8gd2hhdCB0byBsb29rIGluIG1lZGljYXRpb24gcmVxdWVzdCAvIHN0YXRlbWVudHMNCiAgICBjb25zdCBjaXRhbG9wcmFtQ29kZXMgPSBbIjIwNDQ0NyIsICIzNzI3MjkwMDkiXTsvLyB3aGF0IHRvIGxvb2sgaW4gbWVkaWNhdGlvbiByZXF1ZXN0IC8gc3RhdGVtZW50cw0KDQogICAgbGV0IGhhc0xvd1BvdGFzc2l1bSA9IGZhbHNlOw0KICAgIGxldCB0YWtpbmdDaXRhbG9wcmFtID0gZmFsc2U7DQoNCiAgICAvLyBJbmRleCBtZWRpY2F0aW9ucyBieSByZWZlcmVuY2UgSUQNCiAgICBjb25zdCBtZWRpY2F0aW9uc0J5SWQgPSBuZXcgTWFwKCk7DQogICAgaXBzRGF0YS5lbnRyeS5mb3JFYWNoKChlbnRyeSkgPT4gew0KICAgICAgICBpZiAoZW50cnkucmVzb3VyY2U/LnJlc291cmNlVHlwZSA9PT0gIk1lZGljYXRpb24iICYmIGVudHJ5LnJlc291cmNlLmlkKSB7DQogICAgICAgICAgICBtZWRpY2F0aW9uc0J5SWQuc2V0KGBNZWRpY2F0aW9uLyR7ZW50cnkucmVzb3VyY2UuaWR9YCwgZW50cnkucmVzb3VyY2UpOw0KICAgICAgICB9DQogICAgfSk7DQoNCiAgICBmb3IgKGNvbnN0IGVudHJ5IG9mIGlwc0RhdGEuZW50cnkpIHsNCiAgICAgICAgY29uc3QgcmVzID0gZW50cnkucmVzb3VyY2U7DQogICAgICAgIGlmICghcmVzKSBjb250aW51ZTsNCg0KICAgICAgICAvLyBDaGVjayBwb3Rhc3NpdW0NCiAgICAgICAgaWYgKA0KICAgICAgICAgICAgcmVzLnJlc291cmNlVHlwZSA9PT0gIk9ic2VydmF0aW9uIiAmJg0KICAgICAgICAgICAgcmVzLmNvZGU/LmNvZGluZyAmJg0KICAgICAgICAgICAgdHlwZW9mIHJlcy52YWx1ZVF1YW50aXR5Py52YWx1ZSA9PT0gIm51bWJlciINCiAgICAgICAgKSB7DQogICAgICAgICAgICBjb25zdCBpc0sgPSByZXMuY29kZS5jb2Rpbmcuc29tZSgNCiAgICAgICAgICAgICAgICAoYykgPT4NCiAgICAgICAgICAgICAgICAgICAgcG90YXNzaXVtQ29kZXMuaW5jbHVkZXMoYy5jb2RlKSB8fA0KICAgICAgICAgICAgICAgICAgICBjLmRpc3BsYXk/LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoInBvdGFzc2l1bSIpDQogICAgICAgICAgICApOw0KICAgICAgICAgICAgaWYgKGlzSyAmJiByZXMudmFsdWVRdWFudGl0eS52YWx1ZSA8IDMuNSkgew0KICAgICAgICAgICAgICAgIGhhc0xvd1BvdGFzc2l1bSA9IHRydWU7DQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coIuKaoO+4jyBMb3cgSys6IiwgcmVzLnZhbHVlUXVhbnRpdHkudmFsdWUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgLy8gTWVkaWNhdGlvblN0YXRlbWVudCBvciBNZWRpY2F0aW9uUmVxdWVzdA0KICAgICAgICBpZiAoWyJNZWRpY2F0aW9uU3RhdGVtZW50IiwgIk1lZGljYXRpb25SZXF1ZXN0Il0uaW5jbHVkZXMocmVzLnJlc291cmNlVHlwZSkpIHsNCiAgICAgICAgICAgIGxldCBjb2RlcyA9IFtdOw0KDQogICAgICAgICAgICAvLyBDYXNlIDE6IG1lZGljYXRpb25Db2RlYWJsZUNvbmNlcHQNCiAgICAgICAgICAgIGlmIChyZXMubWVkaWNhdGlvbkNvZGVhYmxlQ29uY2VwdD8uY29kaW5nKSB7DQogICAgICAgICAgICAgICAgY29kZXMgPSByZXMubWVkaWNhdGlvbkNvZGVhYmxlQ29uY2VwdC5jb2Rpbmc7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIENhc2UgMjogbWVkaWNhdGlvblJlZmVyZW5jZSB0byBNZWRpY2F0aW9uIHJlc291cmNlDQogICAgICAgICAgICBpZiAocmVzLm1lZGljYXRpb25SZWZlcmVuY2U/LnJlZmVyZW5jZSkgew0KICAgICAgICAgICAgICAgIGNvbnN0IG1lZFJlZiA9IHJlcy5tZWRpY2F0aW9uUmVmZXJlbmNlLnJlZmVyZW5jZTsNCiAgICAgICAgICAgICAgICBjb25zdCBtZWQgPSBtZWRpY2F0aW9uc0J5SWQuZ2V0KG1lZFJlZik7DQogICAgICAgICAgICAgICAgaWYgKG1lZD8uY29kZT8uY29kaW5nKSB7DQogICAgICAgICAgICAgICAgICAgIGNvZGVzID0gY29kZXMuY29uY2F0KG1lZC5jb2RlLmNvZGluZyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBFdmFsdWF0ZSBhbGwgZm91bmQgY29kZXMNCiAgICAgICAgICAgIGZvciAoY29uc3QgY29kaW5nIG9mIGNvZGVzKSB7DQogICAgICAgICAgICAgICAgY29uc3QgbWF0Y2hCeUNvZGUgPSBjaXRhbG9wcmFtQ29kZXMuaW5jbHVkZXMoY29kaW5nLmNvZGUpOw0KICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoQnlUZXh0ID0gY2l0YWxvcHJhbUtleXdvcmRzLnNvbWUoKGt3KSA9Pg0KICAgICAgICAgICAgICAgICAgICAoY29kaW5nLmRpc3BsYXkgfHwgIiIpLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoa3cpDQogICAgICAgICAgICAgICAgKTsNCg0KICAgICAgICAgICAgICAgIGlmIChtYXRjaEJ5Q29kZSB8fCBtYXRjaEJ5VGV4dCkgew0KICAgICAgICAgICAgICAgICAgICB0YWtpbmdDaXRhbG9wcmFtID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIvCfkoogQ2l0YWxvcHJhbSBtYXRjaGVkIHZpYSBjb2RlIG9yIGRpc3BsYXk6IiwgY29kaW5nLmNvZGUpOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCg0KICAgIC8vIGVQSSB0cmFzbGF0aW9uIGZyb20gdGVybWlub2xvZ3kgY29kZXMgdG8gdGhlaXIgaHVtYW4gcmVkYWJsZSB0cmFuc2xhdGlvbnMgaW4gdGhlIHNlY3Rpb25zDQogICAgbGV0IGNvbXBvc2l0aW9ucyA9IDA7DQogICAgbGV0IGNhdGVnb3JpZXMgPSBbXTsNCiAgICBlcGkuZW50cnkuZm9yRWFjaCgoZW50cnkpID0+IHsNCiAgICAgICAgaWYgKGVudHJ5LnJlc291cmNlLnJlc291cmNlVHlwZSA9PSAiQ29tcG9zaXRpb24iKSB7DQogICAgICAgICAgICBjb21wb3NpdGlvbnMrKzsNCiAgICAgICAgICAgIC8vSXRlcmF0ZWQgdGhyb3VnaCB0aGUgQ29uZGl0aW9uIGVsZW1lbnQgc2VhcmNoaW5nIGZvciBjb25kaXRpb25zDQogICAgICAgICAgICBlbnRyeS5yZXNvdXJjZS5leHRlbnNpb24uZm9yRWFjaCgoZWxlbWVudCkgPT4gew0KDQogICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHBvc2l0aW9uIG9mIHRoZSBleHRlbnNpb25bMV0gaXMgY29ycmVjdA0KICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LmV4dGVuc2lvblsxXS51cmwgPT0gImNvbmNlcHQiKSB7DQogICAgICAgICAgICAgICAgICAgIC8vIFNlYXJjaCB0aHJvdWdoIHRoZSBkaWZmZXJlbnQgdGVybWlub2xvZ2llcyB0aGF0IG1heSBiZSBhdmFpYmxlIHRvIGNoZWNrIGluIHRoZSBjb25kaXRpb24NCiAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuZXh0ZW5zaW9uWzFdLnZhbHVlQ29kZWFibGVSZWZlcmVuY2UuY29uY2VwdCAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuZXh0ZW5zaW9uWzFdLnZhbHVlQ29kZWFibGVSZWZlcmVuY2UuY29uY2VwdC5jb2RpbmcuZm9yRWFjaCgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoY29kaW5nKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJFeHRlbnNpb246ICIgKyBlbGVtZW50LmV4dGVuc2lvblswXS52YWx1ZVN0cmluZyArICI6IiArIGNvZGluZy5jb2RlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgY29kZSBpcyBpbiB0aGUgbGlzdCBvZiBjYXRlZ29yaWVzIHRvIHNlYXJjaA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobGlzdE9mQ2F0ZWdvcmllc1RvU2VhcmNoLnNvbWUoaXRlbSA9PiBpdGVtLmNvZGUgPT09IGNvZGluZy5jb2RlICYmIGl0ZW0uc3lzdGVtID09PSBjb2Rpbmcuc3lzdGVtKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGNhdGVnb3J5IGlzIGFscmVhZHkgaW4gdGhlIGxpc3Qgb2YgY2F0ZWdvcmllcw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcmllcy5wdXNoKGVsZW1lbnQuZXh0ZW5zaW9uWzBdLnZhbHVlU3RyaW5nKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgIH0pOw0KICAgIGlmIChjb21wb3NpdGlvbnMgPT0gMCkgew0KICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0JhZCBlUEk6IG5vIGNhdGVnb3J5ICJDb21wb3NpdGlvbiIgZm91bmQnKTsNCiAgICB9DQoNCiAgICBpZiAoY2F0ZWdvcmllcy5sZW5ndGggPT0gMCkgew0KICAgICAgICAvLyB0aHJvdyBuZXcgRXJyb3IoIk5vIGNhdGVnb3JpZXMgZm91bmQiLCBjYXRlZ29yaWVzKTsNCiAgICAgICAgcmV0dXJuIGh0bWxEYXRhOw0KICAgIH0NCiAgICBpZiAoaGFzTG93UG90YXNzaXVtICYmIHRha2luZ0NpdGFsb3ByYW0pIHsNCiAgICAgICAgcmV0dXJuIGF3YWl0IGFubm90YXRlSFRNTHNlY3Rpb24oY2F0ZWdvcmllcywgZW5oYW5jZVRhZyk7DQogICAgfQ0KICAgIGVsc2Ugew0KDQogICAgICAgIGNvbnNvbGUud2FybigiTm8gUVQgcHJvbG9uZ2F0aW9uIHJpc2sgY29uZGl0aW9uIG1ldC4iKTsNCiAgICAgICAgcmV0dXJuIGh0bWxEYXRhOw0KICAgIH0NCg0KfTsNCg0KDQpmdW5jdGlvbiBnZXRSZXBvcnQobGFuZyA9ICJlbiIpIHsNCiAgICBjb25zb2xlLmxvZygiR2VuZXJhdGluZyByZXBvcnQgaW4gbGFuZ3VhZ2U6IiwgbGFuZyk7DQogICAgcmV0dXJuIHsgbWVzc2FnZTogZ2V0RXhwbGFuYXRpb24obGFuZyksIHN0YXR1czogIiIgfTsNCg0KDQp9DQoNCi8vIC0tLSBHZXQgdXNlci1mYWNpbmcgcmVwb3J0IHNlbnRlbmNlIGluIHRoZSBzZWxlY3RlZCBsYW5ndWFnZSAtLS0NCmZ1bmN0aW9uIGdldEV4cGxhbmF0aW9uKGxhbmcgPSAiZW4iKSB7DQogICAgY29uc29sZS5sb2coIkdlbmVyYXRpbmcgZXhwbGFuYXRpb24gaW4gbGFuZ3VhZ2U6IiwgbGFuZyk7DQogICAgcmV0dXJuICIiOw0KfQ0KDQovLyAtLS0gRXhwb3J0ZWQgQVBJIC0tLQ0KcmV0dXJuIHsNCiAgICBlbmhhbmNlOiBlbmhhbmNlLA0KICAgIGdldFNwZWNpZmljYXRpb246IGdldFNwZWNpZmljYXRpb24sDQogICAgZXhwbGFuYXRpb246IChsYW5ndWFnZSkgPT4gZ2V0RXhwbGFuYXRpb24obGFuZ3VhZ2UgfHwgbGFuZyB8fCAiZW4iKSwNCiAgICByZXBvcnQ6IChsYW5ndWFnZSkgPT4gZ2V0UmVwb3J0KGxhbmd1YWdlIHx8IGxhbmcgfHwgImVuIiksDQp9Ow0K",
      "_title": {
        "extension": [
          {
            "url": "http://hl7.org/fhir/StructureDefinition/translation",
            "extension": [
              {
                "url": "lang",
                "valueCode": "es"
              },
              {
                "url": "content",
                "valueString": "Lente para el riesgo de prolongación del QT"
              }
            ]
          },
          {
            "url": "http://hl7.org/fhir/StructureDefinition/translation",
            "extension": [
              {
                "url": "lang",
                "valueCode": "pt"
              },
              {
                "url": "content",
                "valueString": "Lente para o risco de prolongamento do QT"
              }
            ]
          },
          {
            "url": "http://hl7.org/fhir/StructureDefinition/translation",
            "extension": [
              {
                "url": "lang",
                "valueCode": "da"
              },
              {
                "url": "content",
                "valueString": "Linse til QT-forlængelsesrisiko"
              }
            ]
          }
        ]
      }
    }
  ]
}